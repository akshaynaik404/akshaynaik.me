importScripts("./serviceworker-cache-polyfill.js");var CACHE_VERSION=18,CURRENT_CACHES={prefetch:"prefetch-cache-v"+CACHE_VERSION};self.addEventListener("install",function(e){var t=Date.now(),n=["./img/my-pic.jpg","./style.css","https://fonts.googleapis.com/css?family=Roboto"];console.log("Handling install event. Resources to prefetch:",n),e.waitUntil(caches.open(CURRENT_CACHES.prefetch).then(function(e){var o=n.map(function(n){var o=new URL(n,location.href);o.search+=(o.search?"&":"?")+"cache-bust="+t;var c=new Request(o,{mode:"no-cors"});return fetch(c).then(function(t){if(t.status>=400)throw new Error("request for "+n+" failed with status "+t.statusText);return e.put(n,t)})["catch"](function(e){console.error("Not caching "+n+" due to "+e)})});return Promise.all(o).then(function(){console.log("Pre-fetching complete.")})})["catch"](function(e){console.error("Pre-fetching failed:",e)}))}),self.addEventListener("activate",function(e){var t=Object.keys(CURRENT_CACHES).map(function(e){return CURRENT_CACHES[e]});e.waitUntil(caches.keys().then(function(e){return Promise.all(e.map(function(e){return-1===t.indexOf(e)?(console.log("Deleting out of date cache:",e),caches["delete"](e)):void 0}))}))}),self.addEventListener("fetch",function(e){console.log("Handling fetch event for",e.request.url),e.respondWith(caches.match(e.request).then(function(t){return t?(console.log("Found response in cache:",t),t):(console.log("No response found in cache. About to fetch from network..."),fetch(e.request).then(function(e){return console.log("Response from network is:",e),e})["catch"](function(e){throw console.error("Fetching failed:",e),e}))}))});
